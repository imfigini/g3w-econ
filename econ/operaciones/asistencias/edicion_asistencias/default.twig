{% extends "kernel/pagelet.twig" %}
{% block contenido %}

{% if this.data.clase_detalle %}
    <form class='form-renglones' action='{{ this.data.url_guardar }}' method='post'>
	<input type="hidden" name="clase[ID]" value="{{ this.data.clase_id }}">
        <input type="hidden" name="clase[MATERIA]" value="{{this.data.materia}}">
	<input type="hidden" name="clase[FECHA]" value="{{ this.data.fecha }}">
        <input type="hidden" name="clase[DIA_SEMANA]" value="{{this.data.dia_semana}}">
        <input type="hidden" name="clase[HS_COMIENZO_CLASE]" value="{{this.data.hs_comienzo_clase}}">    
	<input type="hidden" name="clase[FILAS]" value="{{ this.data.filas }}">

	{% for alumno in this.data.clase_detalle %}
            {% set asistio = (alumno.INASISTENCIA == 0) %}
            {% if (alumno.MOTIVO_JUSTIFIC) %} 
                {% set motivo_alu = alumno.MOTIVO_JUSTIFIC %} 
            {% else %} 
                {% set motivo_alu = alumno.MOTIVO_INASIST %} 
            {% endif %}
          
            <div class='box-asistencia {{(asistio) ? 'asistio' : 'ausente' }}'>
		<input type="hidden" name="alumnos[{{ alumno.__ID__ }}][PRESENTE]" value="off">
                <label class="select select-inasist" for="alumnos[{{ alumno.__ID__ }}][PRESENTE]" >
                    <select id='alumnos[{{ alumno.__ID__ }}][PRESENTE]' name='alumnos[{{ alumno.__ID__ }}][PRESENTE]'>
                        <option value="-1"> </option>
                        <option value="0" {{ (asistio) ? 'selected' : ''}}>Asistió </option>
                        {% for motivo in this.data.motivos_inasist %}
                            <option value="{{motivo.MOTIVO}}" {{ (motivo_alu == motivo.MOTIVO) ? 'selected' : ''}}>Ausente: {{motivo.DESCRIPCION}}</option>
                        {% endfor %}
                    </select>
                </label>
		<div class='foto pull-left'><img src='{{ alumno.URL_IMAGEN_MEDIANA }}' alt="Imagen ficha"/></div>
		<div class='info pull-right'>
			<div>{{ alumno.NOMBRE }}</div>
			<div>{{ alumno.LEGAJO }}</div>
                        <div>{{ alumno.COMISION_NOMBRE }}</div>
                        <div>{{_self.get_calidad_insc_descripcion(alumno.CALIDAD_INSC)}}</div>
		</div>
            </div>
	{% endfor %}
	<input id='js-guardar-asistencia' type='submit' style='position:absolute' value='{{"guardar"|trans|capitalize}}' class="hide btn btn-info btn-small" />
    </form>
{% else %}
    <div class="alert">{{"no_hay_renglones"|trans|capitalize}}</div>
{% endif %}

{% endblock %}
    
{% macro get_calidad_insc_descripcion(calidad_insc) %}
{% if calidad_insc == 'P' %}{{'Promoción'}}{% endif %}
{% if calidad_insc == 'R' %}{{'Regular'}}{% endif %}
{% if calidad_insc == 'L' %}{{'Libre'}}{% endif %}
{% endmacro %}